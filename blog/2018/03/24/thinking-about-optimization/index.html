<!doctype html><html lang="zh-CN"><head><meta charset="utf-8">

<!-- Prefetch -->
<link rel="preconnect" href="https://fonts.googleapis.com/" crossorigin>
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net/">

<!-- Meta -->
<title>&#x5173;&#x4E8E;&#x6027;&#x80FD;&#x4F18;&#x5316;&#x7684;&#x4E00;&#x4E9B;&#x60F3;&#x6CD5; | Memory-copy</title>

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- Google fonts -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lobster&amp;display=swap&amp;text=Memory-copy0123456789">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inconsolata&amp;display=swap">
<link rel="shortcut icon" href="/assets/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/assets/favicon-48x48.png"><link rel="manifest" href="/assets/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#7f9cf5"><meta name="application-name" content="Memory-copy"><link rel="apple-touch-icon" sizes="57x57" href="/assets/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/assets/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/assets/apple-touch-icon-1024x1024.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Memory-copy"><meta name="msapplication-TileColor" content="#1a202c"><meta name="msapplication-TileImage" content="/assets/mstile-144x144.png"><meta name="msapplication-config" content="/assets/browserconfig.xml"><script defer="defer" src="/build/runtime.4f81b965ee044866d74b.js"></script><script defer="defer" src="/build/app.c495528d022cb4af101d.js"></script><link href="/build/app.c495528d022cb4af101d.css" rel="stylesheet"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Memory-copy" type="application/atom+xml">
</head><body class="bg-background text-content antialiased scrollbar-dark"><div class="container max-w-3xl mx-auto px-4 flex flex-col min-h-screen"><div class="flex-grow">
<header>
  <nav class="flex py-4 justify-end items-center">
    <a class="ml-5 text-content text-opacity-75 hover:text-accent" href="/about/">About</a><a class="ml-5 text-content text-opacity-75 hover:text-accent" href="/archives/">Archives</a>
    <div class="w-2"></div>
    
      <a class="header-icon-btn rss" title="RSS" href="/atom.xml"></a>
    
      <a class="header-icon-btn github" title="GitHub" target="_blank" rel="noopener" href="https://github.com/andytimes"></a>
    
  </nav>
  <h1 class="flex-shrink-0 font-logo text-white text-5xl leading-none text-right pb-12">
    <a href="/">Memory-copy</a>
  </h1>
</header>
 <main>
  

<article id="post-thinking-about-optimization" class="article-container" itemscope itemtype="https://schema.org/Article">
  <header class="article-header">
    <div class="text-accent leading-none pb-2 text-sm">Mar 24, 2018</div>
    <h1 class="text-2xl lg:text-3xl font-light leading-tight pt-2" itemprop="headline">
      <a class="block hover:text-accent" href="/blog/2018/03/24/thinking-about-optimization/">&#x5173;&#x4E8E;&#x6027;&#x80FD;&#x4F18;&#x5316;&#x7684;&#x4E00;&#x4E9B;&#x60F3;&#x6CD5;</a>
    </h1>
  </header>
  <div class="article-body" itemprop="articleBody">
    <p>&#x6700;&#x8FD1;&#x4E00;&#x76F4;&#x5728;&#x505A;&#x6027;&#x80FD;&#x4F18;&#x5316;&#x65B9;&#x9762;&#x7684;&#x5B66;&#x4E60;&#xFF0C;&#x601D;&#x7EEA;&#x4E07;&#x5343;&#x8426;&#x7ED5;&#xFF0C;&#x6240;&#x4EE5;&#x60F3;&#x8BB0;&#x5F55;&#x4E0B;&#x6765;&#x3002;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x804A;&#x4E00;&#x804A;&#x3002;</p>
<p>&#x968F;&#x7740;&#x63A5;&#x89E6;&#x6E38;&#x620F;&#x7F16;&#x7A0B;&#x7684;&#x6B21;&#x6570;&#x589E;&#x591A;&#xFF0C;&#x5BF9;&#x7A0B;&#x5E8F;&#x7684;&#x6027;&#x80FD;&#x4F18;&#x5316;&#x4E5F;&#x7B97;&#x6709;&#x4E86;&#x4E00;&#x70B9;&#x6B63;&#x786E;&#x7684;&#x7406;&#x89E3;&#x3002;&#x56DE;&#x5FC6;&#x8D77;&#x6765;&#xFF0C;&#x6211;&#x4F9D;&#x65E7;&#x8BB0;&#x5F97;&#x4E4B;&#x524D;&#x4E3A;&#x4E86;&#x63D0;&#x9AD8;&#x7A0B;&#x5E8F;&#x6027;&#x80FD;&#xFF0C;&#x800C;&#x505A;&#x7684;&#x90A3;&#x4E9B;&#x5B9E;&#x5219;&#x65E0;&#x76CA;&#x7684;&#x201C;&#x4F18;&#x5316;&#x201D;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<span id="more"></span>
<pre><code class="language-c">void swap(int *x, int *y)
{
        int tmp = *x;
        *x = *y;
        *y = tmp;
}

void swap_by_xor(int *x, int *y)
{
        *x ^= *y;
        *y ^= *x;
        *x ^= *y;
}
</code></pre>
<p>&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x505A;&#x7684;&#x5DE5;&#x4F5C;&#x90FD;&#x662F;&#x4E00;&#x6837;&#xFF1A;&#x4EA4;&#x6362;&#x4E24;&#x4E2A;&#x6574;&#x578B;&#x53D8;&#x91CF;&#x7684;&#x503C;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4F7F;&#x7528;&#x5E38;&#x89C4;&#x65B9;&#x6CD5;&#xFF08;&#x5229;&#x7528;&#x4E34;&#x65F6;&#x53D8;&#x91CF;&#xFF09;&#x3002;&#x800C;&#x7B2C;&#x4E8C;&#x4E2A;&#x51FD;&#x6570; swap_by_xor() &#x4F7F;&#x7528;&#x5F02;&#x6216;&#xFF08;xor&#xFF09;&#xFF0C;&#x4F7F;&#x5F97;&#x4E0D;&#x9700;&#x7528;&#x4E34;&#x65F6;&#x53D8;&#x91CF;&#x4FBF;&#x53EF;&#x5B8C;&#x6210;&#x4EA4;&#x6362;&#xFF08;&#x5F02;&#x6216;&#x4E24;&#x6B21;&#x53EF;&#x5F97;&#x5230;&#x539F;&#x503C;&#xFF09;&#xFF0C;&#x8FD9;&#x6837;&#x4E5F;&#x5C31;&#x514D;&#x53BB;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x5F00;&#x8F9F;&#x7A7A;&#x95F4;&#x3002;&#x5982;&#x679C;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x6539;&#x5199;&#x6210;&#x4EA4;&#x6362;/&#x7FFB;&#x8F6C;&#x6570;&#x7EC4;&#x4E4B;&#x7C7B;&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x51CF;&#x5C11;&#x7684;&#x5185;&#x5B58;&#x8BFB;&#x5199;&#x6B21;&#x6570;&#x4FBF;&#x4F1A;&#x76F8;&#x5F53;&#x53EF;&#x89C2;&#x3002;</p>
<p>&#x7136;&#x800C;&#xFF0C;&#x8FD9;&#x6837;&#x8003;&#x8651;&#x5E76;&#x4E0D;&#x6B63;&#x786E;&#xFF0C;&#x6C47;&#x7F16;&#x540E;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF08;x86_64 gcc 7.2&#xFF0C;O2 &#x4F18;&#x5316;&#xFF09;&#xFF1A;</p>
<pre><code class="language-asm">swap:
        movl    (%rdi), %eax
        movl    (%rsi), %edx
        movl    %edx, (%rdi)
        movl    %eax, (%rsi)
        ret
swap_by_xor:
        movl    (%rdi), %eax
        xorl    (%rsi), %eax
        movl    %eax, (%rdi)
        xorl    (%rsi), %eax
        movl    %eax, (%rsi)
        xorl    %eax, (%rdi)
        ret
</code></pre>
<p>swap() &#x4E2D;&#x7684;&#x4E34;&#x65F6;&#x53D8;&#x91CF;&#x5B9E;&#x9645;&#x662F;&#x76F4;&#x63A5;&#x653E;&#x5165;&#x4E86;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;&#x5E76;&#x4E0D;&#x8FDB;&#x5165;&#x5185;&#x5B58;&#xFF1B;&#x800C; swap_by_xor()&#xFF0C;&#x5BF9;&#x6BD4; swap()  &#x53CD;&#x800C;&#x591A;&#x4E86;&#x51E0;&#x6761; xor &#x6307;&#x4EE4;&#x3002;&#x7531;&#x6B64;&#x53EF;&#x89C1;&#xFF0C;&#x5B9E;&#x9645;&#x7528; xor &#x201C;&#x4F18;&#x5316;&#x201D; &#x4E0D;&#x80FD;&#x5E26;&#x6765;&#x4EC0;&#x4E48;&#x597D;&#x5904;&#x3002;&#x867D;&#x7136;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x5B9E;&#x9645;&#x6267;&#x884C;&#x901F;&#x5EA6;&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x4F46;&#x5C31;&#x53EF;&#x8BFB;&#x6027;&#x800C;&#x8A00;&#xFF0C;swap() &#x662F;&#x5B8C;&#x80DC; swap_by_xor() &#x7684;&#x3002;</p>
<p>&#x73B0;&#x4EE3;&#x7F16;&#x8BD1;&#x5668;&#x6240;&#x80FD;&#x505A;&#x7684;&#x4F18;&#x5316;&#xFF0C;&#x8FDC;&#x6BD4;&#x4E0A;&#x9762;&#x7684;&#x591A;&#x5F97;&#x591A;&#x3002;&#x56E0;&#x6B64;&#x5199;&#x51FA;&#x903B;&#x8F91;&#x6E05;&#x6670;&#x7684;&#x6E90;&#x4EE3;&#x7801;&#xFF0C;&#x5F80;&#x5F80;&#x4FBF;&#x80FD;&#x751F;&#x6210;&#x9AD8;&#x6548;&#x7684;&#x6C47;&#x7F16;&#x3002;&#x53EA;&#x6709;&#x5728;&#x7F16;&#x8BD1;&#x5668;&#x751F;&#x6210;&#x7684;&#x6C47;&#x7F16;&#x4E0D;&#x7B26;&#x5408;&#x9884;&#x671F;&#x65F6;&#x624D;&#x8003;&#x8651;&#x53BB;&#x6539;&#x8FDB;&#x6E90;&#x4EE3;&#x7801;&#x3002;&#x4E0D;&#x8981;&#x5728;&#x505A;&#x6027;&#x80FD;&#x6D4B;&#x8BD5;&#x4E4B;&#x524D;&#x5C31;&#x5C1D;&#x8BD5;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x80FD;&#x4F1A;&#x5E26;&#x6765;&#x7CDF;&#x7CD5;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>

  </div>
  
  <footer class="article-footer">
    
      <ul class="list-none flex flex-wrap justify-end">
        <li class="pl-2">
            <a class="text-sm text-accent hover:underline" href="/tags/C/">#C++</a>
          </li><li class="pl-2">
            <a class="text-sm text-accent hover:underline" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">#&#x6027;&#x80FD;&#x4F18;&#x5316;</a>
          </li>
      </ul>
      <meta itemprop="keywords" content=",">
    
  </footer>
  <meta itemprop="datePublished" content="2018-03-24T15:50:33.000Z">
  <meta itemprop="dateModified" content="2022-03-26T20:42:57.382Z">
  <div itemprop="author publisher" itemscope itemtype="https://schema.org/Person">
    <meta itemprop="name" content="Andy Deng">
  </div>
</article>

</main>


</div><div class="flex-shrink-0"><footer class="py-12 text-center">
  &#xA9; 2022 Andy Deng<br>
  Powered by <a class="hover:text-accent hover:underline" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>
</footer>
</div></div></body></html>